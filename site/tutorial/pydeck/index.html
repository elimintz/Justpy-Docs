<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Pydeck Visualizations - My Docs</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">JustPy</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Blog <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../blog/ag-grid_to_web_page/" class="dropdown-item">From a Pandas DataFrame to a Web Site with an ag-Grid in 10 Lines of Python</a>
</li>
                                    
<li>
    <a href="../../blog/reactivity/" class="dropdown-item">Reactivity in JustPy</a>
</li>
                                    
<li>
    <a href="../../blog/vue_comparison/" class="dropdown-item">Comparing Vue.js to JustPy</a>
</li>
                                    
<li>
    <a href="../../blog/vue_examples/" class="dropdown-item">JustPy Implementation of Vue.js Examples</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Charts tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../charts_tutorial/chart_components/" class="dropdown-item">Chart Custom Components</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/chart_events/" class="dropdown-item">Chart Events and Methods</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/creating_charts/" class="dropdown-item">Creating Charts</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/introduction/" class="dropdown-item">Highcharts Introduction</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/iris/" class="dropdown-item">Iris Flower Dataset Visualization</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/pandas/" class="dropdown-item">Using Pandas to Create Charts</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/stock_charts/" class="dropdown-item">Stock Charts</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/tooltips/" class="dropdown-item">Tooltips</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/updating_charts/" class="dropdown-item">Updating Charts</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Grids tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../grids_tutorial/adding_html/" class="dropdown-item">Adding HTML to Cells</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/checkbox/" class="dropdown-item">Rendering Checkboxes</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/context_menu/" class="dropdown-item">Adding a Context Menu</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/creating_grids/" class="dropdown-item">Creating Grids</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/database/" class="dropdown-item">Displaying Database Tables and Query Results</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/field_evaluation/" class="dropdown-item">Evaluating Fields using JavaScript</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/grid_api/" class="dropdown-item">Running Grid API Commands</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/grid_events/" class="dropdown-item">Grid Events</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/introduction/" class="dropdown-item">ag-Grid Introduction</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/pandas/" class="dropdown-item">Using Pandas to Create Grids</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">How to <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../how_to/add_row_to_grid/" class="dropdown-item">How to Add a Row to a Grid</a>
</li>
                                    
<li>
    <a href="../../how_to/change_font/" class="dropdown-item">Using Specific Fonts</a>
</li>
                                    
<li>
    <a href="../../how_to/context_menu/" class="dropdown-item">Addiing a Context Menu (right-click in browser)</a>
</li>
                                    
<li>
    <a href="../../how_to/create_select/" class="dropdown-item">How to use the Select HTML Tag</a>
</li>
                                    
<li>
    <a href="../../how_to/login_decorator/" class="dropdown-item">Use Decorators for Request Handlers</a>
</li>
                                    
<li>
    <a href="../../how_to/monitor_idle/" class="dropdown-item">Monitor Inactivity</a>
</li>
                                    
<li>
    <a href="../../how_to/play_audio/" class="dropdown-item">How to Play Audio</a>
</li>
                                    
<li>
    <a href="../../how_to/quasar_full_screen/" class="dropdown-item">How ot Toggle Full Screen Mode in Quasar</a>
</li>
                                    
<li>
    <a href="../../how_to/reload_pages/" class="dropdown-item">Forcing a Hard Reload</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Meadows <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../meadows/general/" class="dropdown-item">General Thoughts</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Quasar tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../quasar_tutorial/QAjaxBar/" class="dropdown-item">QAjaxBar</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QBtnToggle/" class="dropdown-item">QBtnToggle</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QColor/" class="dropdown-item">QColor</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QDate/" class="dropdown-item">QDate and QTime</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QDialog/" class="dropdown-item">QDialog</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QExpansionItem/" class="dropdown-item">QExpansionItem Examples</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QInput/" class="dropdown-item">QInput</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QList/" class="dropdown-item">QList and QItem</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QOptionGroup/" class="dropdown-item">QOptionGroup</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QRating/" class="dropdown-item">QRating</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QSplitter/" class="dropdown-item">QSplitter</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QTree/" class="dropdown-item">QTree</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/introduction/" class="dropdown-item">Quasar Introduction</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/not_working/" class="dropdown-item">Components not Working</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/notify/" class="dropdown-item">Notifications</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../reference/configuration/" class="dropdown-item">Configuration Variables</a>
</li>
                                    
<li>
    <a href="../../reference/htmlcomponent/" class="dropdown-item">HTML Components</a>
</li>
                                    
<li>
    <a href="../../reference/justpy/" class="dropdown-item">The **justpy** Command</a>
</li>
                                    
<li>
    <a href="../../reference/notes/" class="dropdown-item">Notes</a>
</li>
                                    
<li>
    <a href="../../reference/webpage/" class="dropdown-item">The WebPage Class</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../advanced_components/" class="dropdown-item">Advanced Components</a>
</li>
                                    
<li>
    <a href="../ajax/" class="dropdown-item">Using Ajax instead of WebSockets</a>
</li>
                                    
<li>
    <a href="../altair/" class="dropdown-item">Altair Charts</a>
</li>
                                    
<li>
    <a href="../basic_concepts/" class="dropdown-item">The Basic Concepts</a>
</li>
                                    
<li>
    <a href="../before_after_events/" class="dropdown-item">The <span style="color: red">before</span> and <span style="color: red">after</span> Events</a>
</li>
                                    
<li>
    <a href="../bokeh/" class="dropdown-item">Bokeh Charts</a>
</li>
                                    
<li>
    <a href="../configuration/" class="dropdown-item">Configuration</a>
</li>
                                    
<li>
    <a href="../custom_components/" class="dropdown-item">Creating Your Own Components</a>
</li>
                                    
<li>
    <a href="../deployment/" class="dropdown-item">Deployment</a>
</li>
                                    
<li>
    <a href="../drag_and_drop/" class="dropdown-item">Drag and Drop</a>
</li>
                                    
<li>
    <a href="../equations/" class="dropdown-item">Equations</a>
</li>
                                    
<li>
    <a href="../form/" class="dropdown-item">Form Component</a>
</li>
                                    
<li>
    <a href="../getting_started/" class="dropdown-item">Getting Started</a>
</li>
                                    
<li>
    <a href="../handling_events/" class="dropdown-item">Handling Events</a>
</li>
                                    
<li>
    <a href="../html_components/" class="dropdown-item">HTML Components</a>
</li>
                                    
<li>
    <a href="../input/" class="dropdown-item">Input Component</a>
</li>
                                    
<li>
    <a href="../markdown/" class="dropdown-item">Using Markdown</a>
</li>
                                    
<li>
    <a href="../matplotlib/" class="dropdown-item">Creating matplotlib Charts</a>
</li>
                                    
<li>
    <a href="../model_and_data/" class="dropdown-item">The model and data Attributes</a>
</li>
                                    
<li>
    <a href="../page_events/" class="dropdown-item">Page Events</a>
</li>
                                    
<li>
    <a href="../plotly/" class="dropdown-item">Plotly Charts</a>
</li>
                                    
<li>
    <a href="../pushing_data/" class="dropdown-item">Pushing Data to Web Pages</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Pydeck Visualizations</a>
</li>
                                    
<li>
    <a href="../request_object/" class="dropdown-item">The Request Object</a>
</li>
                                    
<li>
    <a href="../routes/" class="dropdown-item">Routes</a>
</li>
                                    
<li>
    <a href="../sessions/" class="dropdown-item">Sessions in JustPy</a>
</li>
                                    
<li>
    <a href="../static/" class="dropdown-item">Static Files</a>
</li>
                                    
<li>
    <a href="../svg_components/" class="dropdown-item">SVG Components</a>
</li>
                                    
<li>
    <a href="../tailwind/" class="dropdown-item">Tailwind</a>
</li>
                                    
<li>
    <a href="../transitions/" class="dropdown-item">Transitions</a>
</li>
                                    
<li>
    <a href="../uploading_files/" class="dropdown-item">Downloading and Uploading Files</a>
</li>
                                    
<li>
    <a href="../working_with_html/" class="dropdown-item">Parsing and Using HTML</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../pushing_data/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../request_object/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#pydeck-visualizations" class="nav-link">Pydeck Visualizations</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="pydeck-visualizations">Pydeck Visualizations</h1>
<p><a href="https://deckgl.readthedocs.io/en/latest/">Pydeck visualizations</a> are supported by JustPy using the <code>PyDeckFrame</code> component.</p>
<p>Set the <code>deck</code> attribute of the <code>PyDeckFrame</code> instance to a <a href="https://deckgl.readthedocs.io/en/latest/deck.html">pydeck deck</a></p>
<p>As its name implies, the component inserts a HTML frame in the page which includes the HTML produced by the <code>to_html()</code> method of <code>Deck</code>. </p>
<p>The component also supports a <code>transition_duration</code> attribute. When a visualization changes, this attribute determines the time length of the transition between the old frame and the new frame. The time is designated in seconds and the default is 0.1 seconds.</p>
<p>The example below is based on a <a href="https://github.com/streamlit/demo-uber-nyc-pickups">streamlit demo app</a></p>
<p>!!! warning
    You need to obtain a <a href="https://docs.mapbox.com/help/getting-started/access-tokens/">mapbox api token</a> to have the data render on map tiles</p>
<pre><code class="language-python"># This example is based on a streamlit app: https://github.com/streamlit/demo-uber-nyc-pickups
import justpy as jp

import pandas as pd
import numpy as np
import pydeck as pdk
try:
    import altair as alt
    _has_altair = True
except:
    _has_altair = False


DATE_TIME = &quot;date/time&quot;
DATA_URL = (
    &quot;http://s3-us-west-2.amazonaws.com/streamlit-demo-data/uber-raw-data-sep14.csv.gz&quot;
)


def load_data(nrows):
    data = pd.read_csv(DATA_URL, nrows=nrows)
    lowercase = lambda x: str(x).lower()
    data.rename(lowercase, axis=&quot;columns&quot;, inplace=True)
    data[DATE_TIME] = pd.to_datetime(data[DATE_TIME])
    return data


data = load_data(100000)
lowercase = lambda x: str(x).lower()
data.rename(lowercase, axis=&quot;columns&quot;, inplace=True)
data[DATE_TIME] = pd.to_datetime(data[DATE_TIME])


def map_deck(data, lat, lon, zoom):
    deck = (pdk.Deck(
        # https://docs.mapbox.com/help/getting-started/access-tokens/
        api_keys={'mapbox': 'Insert your mapbox api token here'},
        map_provider='mapbox',
        map_style=&quot;light&quot;,
        initial_view_state={
            &quot;latitude&quot;: lat,
            &quot;longitude&quot;: lon,
            &quot;zoom&quot;: zoom,
            &quot;pitch&quot;: 50,
        },
        layers=[
            pdk.Layer(
                &quot;HexagonLayer&quot;,
                data=data,
                get_position=[&quot;lon&quot;, &quot;lat&quot;],
                radius=100,
                elevation_scale=4,
                elevation_range=[0, 1000],
                pickable=True,
                extruded=True,
            ),
        ]
    ))
    return deck


airports = {
    'La Guardia': [40.7900, -73.8700],
    'JFK': [40.6650, -73.7821],
    'Newark': [40.7090, -74.1805]
}

zoom_level_airports = 12
zoom_level_main = 11
midpoint = (np.average(data[&quot;lat&quot;]), np.average(data[&quot;lon&quot;]))


def create_histogram(hour_selected):
    filtered = data[
        (data[DATE_TIME].dt.hour &gt;= hour_selected) &amp; (data[DATE_TIME].dt.hour &lt; (hour_selected + 1))
        ]
    hist = np.histogram(filtered[DATE_TIME].dt.minute, bins=60, range=(0, 60))[0]
    chart_data = pd.DataFrame({&quot;minute&quot;: range(60), &quot;pickups&quot;: hist})
    chart = alt.Chart(chart_data).mark_area(
        interpolate='step-after',
    ).encode(
        x=alt.X(&quot;minute:Q&quot;, scale=alt.Scale(nice=False)),
        y=alt.Y(&quot;pickups:Q&quot;),
        tooltip=['minute', 'pickups']
    ).configure_mark(
        opacity=0.5,
        color='red'
    ).properties(
        width='container',
        height=200
    )
    return chart


async def slider_change(self, msg):
    wp = msg.page
    hour = int(self.value)
    wp.all_caption.text = f'All New York City from {hour}:00 to {hour+1}:00'
    hour_data = data[data[DATE_TIME].dt.hour == hour]
    wp.decks['main'].deck = map_deck(hour_data, midpoint[0], midpoint[1], zoom_level_main)
    for airport, coords in airports.items():
        wp.decks[airport].deck = map_deck(hour_data, coords[0], coords[1], zoom_level_airports)
    if _has_altair:
        wp.histogram.chart = create_histogram(self.value)
        wp.histogram_caption.text = f'Breakdown of rides per minute between {hour}:00 and {hour+1}:00'


def pydeck_demo(request):
    wp = jp.QuasarPage(tailwind=True, title='Uber NYC Pickups')
    wp.decks = {}
    slider_div = jp.Div(a=wp, classes='flex ml-4', style='width: 50%; margin-top: 20px')
    jp.Div(text='Select hour of pickup:', a=slider_div, classes='pt-3 text-xl font-bold ')
    s1 = jp.Span(classes='ml-6 mt-1', style='width: 50%',a=slider_div)
    jp.QSlider(classes='w-64', min=0, max=23, a=s1, label=True,
               label_always=True, markers=True, step=1, snap=True, color='red',
               change=slider_change)
    deck_div = jp.Div(classes='flex ml-2', a=wp)
    hour_data = data[data[DATE_TIME].dt.hour == int(0)]
    deck = map_deck(hour_data, midpoint[0], midpoint[1], zoom_level_main)
    all_div = jp.Div(a=deck_div)
    wp.all_caption = jp.Div(text='All New York City from 0:00 to 1:00', a=all_div, style='margin: 10px;', classes='text-xl font-bold')
    wp.decks['main'] = jp.PyDeckFrame(a=all_div, deck=deck, style='margin: 10px; height: 400px; width: 450px', transition_duration=0.5)
    for airport, coords in airports.items():
        airport_deck = map_deck(hour_data, coords[0], coords[1], zoom_level_airports)
        airport_div = jp.Div(a=deck_div)
        jp.Div(text=f'{airport} Airport', a=airport_div, style='margin: 10px;', classes='text-xl font-bold')
        wp.decks[airport] = jp.PyDeckFrame(a=airport_div, deck=airport_deck, style='margin: 10px; height: 400px; width: 250px',
                              transition_duration=0.5)
    if _has_altair:
        chart = create_histogram(0)
        wp.histogram_caption = jp.Div(text='Breakdown of rides per minute between 0:00 and 1:00', a=wp, style='margin-left: 30px;', classes='text-xl font-bold')
        wp.histogram = jp.AltairChart(chart=chart, a=wp, style='padding: 10px; width: 100%;')
    return wp


jp.justpy(pydeck_demo, VEGA=True)

</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
