<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Creating matplotlib Charts - My Docs</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">JustPy</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Blog <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../blog/ag-grid_to_web_page/" class="dropdown-item">From a Pandas DataFrame to a Web Site with an ag-Grid in 10 Lines of Python</a>
</li>
                                    
<li>
    <a href="../../blog/reactivity/" class="dropdown-item">Reactivity in JustPy</a>
</li>
                                    
<li>
    <a href="../../blog/vue_comparison/" class="dropdown-item">Comparing Vue.js to JustPy</a>
</li>
                                    
<li>
    <a href="../../blog/vue_examples/" class="dropdown-item">JustPy Implementation of Vue.js Examples</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Charts tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../charts_tutorial/chart_components/" class="dropdown-item">Chart Custom Components</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/chart_events/" class="dropdown-item">Chart Events and Methods</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/creating_charts/" class="dropdown-item">Creating Charts</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/introduction/" class="dropdown-item">Highcharts Introduction</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/iris/" class="dropdown-item">Iris Flower Dataset Visualization</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/pandas/" class="dropdown-item">Using Pandas to Create Charts</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/stock_charts/" class="dropdown-item">Stock Charts</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/tooltips/" class="dropdown-item">Tooltips</a>
</li>
                                    
<li>
    <a href="../../charts_tutorial/updating_charts/" class="dropdown-item">Updating Charts</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Grids tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../grids_tutorial/adding_html/" class="dropdown-item">Adding HTML to Cells</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/checkbox/" class="dropdown-item">Rendering Checkboxes</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/context_menu/" class="dropdown-item">Adding a Context Menu</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/creating_grids/" class="dropdown-item">Creating Grids</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/database/" class="dropdown-item">Displaying Database Tables and Query Results</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/field_evaluation/" class="dropdown-item">Evaluating Fields using JavaScript</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/grid_api/" class="dropdown-item">Running Grid API Commands</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/grid_events/" class="dropdown-item">Grid Events</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/introduction/" class="dropdown-item">ag-Grid Introduction</a>
</li>
                                    
<li>
    <a href="../../grids_tutorial/pandas/" class="dropdown-item">Using Pandas to Create Grids</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">How to <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../how_to/add_row_to_grid/" class="dropdown-item">How to Add a Row to a Grid</a>
</li>
                                    
<li>
    <a href="../../how_to/change_font/" class="dropdown-item">Using Specific Fonts</a>
</li>
                                    
<li>
    <a href="../../how_to/context_menu/" class="dropdown-item">Addiing a Context Menu (right-click in browser)</a>
</li>
                                    
<li>
    <a href="../../how_to/create_select/" class="dropdown-item">How to use the Select HTML Tag</a>
</li>
                                    
<li>
    <a href="../../how_to/login_decorator/" class="dropdown-item">Use Decorators for Request Handlers</a>
</li>
                                    
<li>
    <a href="../../how_to/monitor_idle/" class="dropdown-item">Monitor Inactivity</a>
</li>
                                    
<li>
    <a href="../../how_to/play_audio/" class="dropdown-item">How to Play Audio</a>
</li>
                                    
<li>
    <a href="../../how_to/quasar_full_screen/" class="dropdown-item">How ot Toggle Full Screen Mode in Quasar</a>
</li>
                                    
<li>
    <a href="../../how_to/reload_pages/" class="dropdown-item">Forcing a Hard Reload</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Meadows <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../meadows/general/" class="dropdown-item">General Thoughts</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Quasar tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../quasar_tutorial/QAjaxBar/" class="dropdown-item">QAjaxBar</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QBtnToggle/" class="dropdown-item">QBtnToggle</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QColor/" class="dropdown-item">QColor</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QDate/" class="dropdown-item">QDate and QTime</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QDialog/" class="dropdown-item">QDialog</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QExpansionItem/" class="dropdown-item">QExpansionItem Examples</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QInput/" class="dropdown-item">QInput</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QList/" class="dropdown-item">QList and QItem</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QOptionGroup/" class="dropdown-item">QOptionGroup</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QRating/" class="dropdown-item">QRating</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QSplitter/" class="dropdown-item">QSplitter</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/QTree/" class="dropdown-item">QTree</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/introduction/" class="dropdown-item">Quasar Introduction</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/not_working/" class="dropdown-item">Components not Working</a>
</li>
                                    
<li>
    <a href="../../quasar_tutorial/notify/" class="dropdown-item">Notifications</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../reference/configuration/" class="dropdown-item">Configuration Variables</a>
</li>
                                    
<li>
    <a href="../../reference/htmlcomponent/" class="dropdown-item">HTML Components</a>
</li>
                                    
<li>
    <a href="../../reference/justpy/" class="dropdown-item">The **justpy** Command</a>
</li>
                                    
<li>
    <a href="../../reference/notes/" class="dropdown-item">Notes</a>
</li>
                                    
<li>
    <a href="../../reference/webpage/" class="dropdown-item">The WebPage Class</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Tutorial <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../advanced_components/" class="dropdown-item">Advanced Components</a>
</li>
                                    
<li>
    <a href="../ajax/" class="dropdown-item">Using Ajax instead of WebSockets</a>
</li>
                                    
<li>
    <a href="../altair/" class="dropdown-item">Altair Charts</a>
</li>
                                    
<li>
    <a href="../basic_concepts/" class="dropdown-item">The Basic Concepts</a>
</li>
                                    
<li>
    <a href="../before_after_events/" class="dropdown-item">The <span style="color: red">before</span> and <span style="color: red">after</span> Events</a>
</li>
                                    
<li>
    <a href="../bokeh/" class="dropdown-item">Bokeh Charts</a>
</li>
                                    
<li>
    <a href="../configuration/" class="dropdown-item">Configuration</a>
</li>
                                    
<li>
    <a href="../custom_components/" class="dropdown-item">Creating Your Own Components</a>
</li>
                                    
<li>
    <a href="../deployment/" class="dropdown-item">Deployment</a>
</li>
                                    
<li>
    <a href="../drag_and_drop/" class="dropdown-item">Drag and Drop</a>
</li>
                                    
<li>
    <a href="../equations/" class="dropdown-item">Equations</a>
</li>
                                    
<li>
    <a href="../form/" class="dropdown-item">Form Component</a>
</li>
                                    
<li>
    <a href="../getting_started/" class="dropdown-item">Getting Started</a>
</li>
                                    
<li>
    <a href="../handling_events/" class="dropdown-item">Handling Events</a>
</li>
                                    
<li>
    <a href="../html_components/" class="dropdown-item">HTML Components</a>
</li>
                                    
<li>
    <a href="../input/" class="dropdown-item">Input Component</a>
</li>
                                    
<li>
    <a href="../markdown/" class="dropdown-item">Using Markdown</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Creating matplotlib Charts</a>
</li>
                                    
<li>
    <a href="../model_and_data/" class="dropdown-item">The model and data Attributes</a>
</li>
                                    
<li>
    <a href="../page_events/" class="dropdown-item">Page Events</a>
</li>
                                    
<li>
    <a href="../plotly/" class="dropdown-item">Plotly Charts</a>
</li>
                                    
<li>
    <a href="../pushing_data/" class="dropdown-item">Pushing Data to Web Pages</a>
</li>
                                    
<li>
    <a href="../pydeck/" class="dropdown-item">Pydeck Visualizations</a>
</li>
                                    
<li>
    <a href="../request_object/" class="dropdown-item">The Request Object</a>
</li>
                                    
<li>
    <a href="../routes/" class="dropdown-item">Routes</a>
</li>
                                    
<li>
    <a href="../sessions/" class="dropdown-item">Sessions in JustPy</a>
</li>
                                    
<li>
    <a href="../static/" class="dropdown-item">Static Files</a>
</li>
                                    
<li>
    <a href="../svg_components/" class="dropdown-item">SVG Components</a>
</li>
                                    
<li>
    <a href="../tailwind/" class="dropdown-item">Tailwind</a>
</li>
                                    
<li>
    <a href="../transitions/" class="dropdown-item">Transitions</a>
</li>
                                    
<li>
    <a href="../uploading_files/" class="dropdown-item">Downloading and Uploading Files</a>
</li>
                                    
<li>
    <a href="../working_with_html/" class="dropdown-item">Parsing and Using HTML</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../markdown/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../model_and_data/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#creating-matplotlib-charts" class="nav-link">Creating matplotlib Charts</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#the-matplotlib-component" class="nav-link">The Matplotlib component</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#updating-charts-following-events" class="nav-link">Updating charts following events</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#multiple-charts-on-a-page" class="nav-link">Multiple charts on a page</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#creating-matplotlib-charts-with-pandas" class="nav-link">Creating matplotlib charts with pandas</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#creating-charts-with-seaborn" class="nav-link">Creating charts with seaborn</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="creating-matplotlib-charts">Creating matplotlib Charts</h1>
<p>The most popular Python plotting library is <a href="https://matplotlib.org/index.html">matplotlib</a>. Chances are that if you are interested in visualization, you have already used it. </p>
<p>JustPy includes in its standard component library the component Matplotlib that makes it simple to include matplotlib charts in a web page without having to change any matplotlib command. </p>
<h2 id="the-matplotlib-component">The Matplotlib component</h2>
<p>Run the following example that uses the Matplotlib component:</p>
<pre><code class="language-python">import justpy as jp
import matplotlib.pyplot as plt

def plot_test():
    wp = jp.WebPage()
    plt.plot([0, 1, 4, 9], marker='*', markersize=20, markeredgecolor='red')
    plt.title('Matplotlib Example')
    plt.xlabel('x data')
    plt.ylabel('y data')
    jp.Matplotlib(a=wp)

    # If memory may be an issue, don't forget to close figures not in use anymore
    plt.close()
    return wp

jp.justpy(plot_test)
</code></pre>
<p>The line <code>jp.Matplotlib(a=wp)</code> creates a Matplotlib instance and adds it to <code>wp</code>. </p>
<p>!!! tip
    If you call Matplotlib where you would normally call <code>plt.show()</code> the chart instance is created reflecting all the matplotlib commands issued so far. </p>
<p>The Matplotlib component is a modified Div component whose <code>inner_html</code> attribute is set to the SVG representation of a <a href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.figure.Figure.html">matplotlib figure</a>. </p>
<p>If a matplotlib figure is not specified explicitly when a Matplotlib instance is created (like in the example above), Matplotlib uses the current figure. If you want to put some other figure on the page use the <code>figure</code> keyword when creating the instance or use the <code>set_figure(figure)</code> method of the component after creation.</p>
<p>!!! tip
    Don't forget to close matplotlib figures that are not in use. This will not affect any JustPy Matplotlib instances as the SVG representation that was created from the figure is distinct from the figure and will not be deleted. </p>
<p>In the example below, the first chart created is displayed second and the second chart created is displayed first.</p>
<pre><code class="language-python">import justpy as jp
import matplotlib.pyplot as plt

def plot_test():
    wp = jp.WebPage()

    first_figure = plt.figure()
    plt.plot([0, 1, 4, 9], marker='*', markersize=20, markeredgecolor='red')
    plt.title('First Figure Showing Second')
    plt.xlabel('x data')
    plt.ylabel('y data')

    second_figure = plt.figure()
    plt.plot([0, 1, 4, 9], marker='+', markersize=20, markeredgecolor='red')
    plt.title('Second Figure Showing First')
    plt.xlabel('x data')
    plt.ylabel('y data')

    # Keyword method of setting figure
    jp.Matplotlib(figure=second_figure, a=wp)
    # Using method after creation
    c = jp.Matplotlib(a=wp)
    c.set_figure(first_figure)

    # If memory may be an issue, don't forget to close figures not in use anymore
    plt.close(first_figure)
    plt.close(second_figure)
    return wp

jp.justpy(plot_test)
</code></pre>
<h2 id="updating-charts-following-events">Updating charts following events</h2>
<p>In the example below, each time the button is clicked, another point is added to the chart. This is done by creating a new figure in the event handler and setting the figure of the component to this new figure. In effect, the <code>inner_html</code> attribute of the element is set to the SVG of the new figure.</p>
<pre><code class="language-python">import justpy as jp
import matplotlib.pyplot as plt


def plot_test():
    wp = jp.WebPage()

    f = plt.figure()
    plt.plot([0, 1, 4, 9], marker='*', markersize=20, markeredgecolor='red')
    plt.title('Matplotlib Example')
    plt.xlabel('x data')
    plt.ylabel('y data')
    chart = jp.Matplotlib(a=wp)
    chart.num_points = 4
    plt.close(f)

    b = jp.Button(text='Add Point', a=wp,
                  classes='m-2 bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded')
    b.chart = chart

    def add_point(self, msg):
        self.chart.num_points += 1
        np = self.chart.num_points
        f = plt.figure()
        plt.plot([i*i for i in range(np)], marker='*', markersize=20, markeredgecolor='red')
        plt.title(f'This chart has {np} points')
        plt.xlabel('x data')
        plt.ylabel('y data')
        self.chart.set_figure(f)
        plt.close(f)

    b.on('click', add_point)

    return wp


jp.justpy(plot_test)
</code></pre>
<p>The chart component itself is a JustPy component so it responds also to events. In the example below, clicking the button adds a point to the chart while clicking the chart subtracts a point.</p>
<pre><code class="language-python">import justpy as jp
import matplotlib.pyplot as plt


def plot_test():
    wp = jp.WebPage()
    print(f'start {plt.get_fignums()}')
    f = plt.figure()
    plt.plot([0, 1, 4, 9], marker='*', markersize=20, markeredgecolor='red')
    plt.title('Matplotlib Example')
    plt.xlabel('x data')
    plt.ylabel('y data')
    chart = jp.Matplotlib(a=wp)
    chart.num_points = 4
    plt.close(f)

    b = jp.Button(text='Add Point', a=wp,
                  classes='m-2 bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded')
    b.chart = chart

    def add_point(self, msg):
        self.chart.num_points += 1
        np = self.chart.num_points
        f = plt.figure()
        plt.plot([i*i for i in range(np)], marker='*', markersize=20, markeredgecolor='red')
        plt.title(f'This chart has {np} points')
        plt.xlabel('x data')
        plt.ylabel('y data')
        self.chart.set_figure(f)
        plt.close(f)

    b.on('click', add_point)

    def subtract_point(self, msg):
        self.num_points -= 1
        np = self.num_points
        f = plt.figure()
        plt.plot([i*i for i in range(np)], marker='*', markersize=20, markeredgecolor='red')
        plt.title(f'This chart has {np} points')
        plt.xlabel('x data')
        plt.ylabel('y data')
        self.set_figure(f)
        plt.close(f)

    chart.on('click', subtract_point)

    return wp


jp.justpy(plot_test)
</code></pre>
<h2 id="multiple-charts-on-a-page">Multiple charts on a page</h2>
<p>The program below is very similar to the example above except that it puts the same chart element several times on the page. Since it is the same element, the event handlers modify all the charts.</p>
<pre><code class="language-python">import justpy as jp
import matplotlib.pyplot as plt


def plot_test():
    wp = jp.WebPage()
    print(f'start {plt.get_fignums()}')
    f = plt.figure(figsize=(2, 2))
    plt.plot([0, 1, 4, 9], marker='*', markersize=20, markeredgecolor='red')
    plt.title('Matplotlib Example')
    plt.xlabel('x data')
    plt.ylabel('y data')
    d = jp.Div(classes='flex flex-wrap', a=wp)
    chart = jp.Matplotlib(classes='m-1 p-2')
    for i in range(5):
        d.add(chart)

    chart.num_points = 4
    plt.close(f)

    b = jp.Button(text='Add Point', a=wp,
                  classes='m-2 bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded')
    b.chart = chart

    def add_point(self, msg):
        self.chart.num_points += 1
        np = self.chart.num_points
        f = plt.figure(figsize=(2, 2))
        plt.plot([i*i for i in range(np)], marker='*', markersize=20, markeredgecolor='red')
        plt.title(f'This chart has {np} points')
        plt.xlabel('x data')
        plt.ylabel('y data')
        self.chart.set_figure(f)
        plt.close(f)

    b.on('click', add_point)

    def subtract_point(self, msg):
        self.num_points -= 1
        np = self.num_points
        f = plt.figure(figsize=(2, 2))
        plt.plot([i*i for i in range(np)], marker='*', markersize=20, markeredgecolor='red')
        plt.title(f'This chart has {np} points')
        plt.xlabel('x data')
        plt.ylabel('y data')
        self.set_figure(f)
        plt.close(f)

    chart.on('click', subtract_point)

    return wp

jp.justpy(plot_test)
</code></pre>
<p>If we want to treat each chart separately in the event handlers we need to modify the program. In the program below clicking the button adds a point to all charts while clicking each chart subtracts a point only from the chart clicked.</p>
<pre><code class="language-python">import justpy as jp
import matplotlib.pyplot as plt


def add_point(self, msg):
    for chart in self.chart_list:
        chart.num_points += 1
        np = chart.num_points
        f = plt.figure(figsize=(2, 2))
        plt.plot([i * i for i in range(np)], marker='*', markersize=20, markeredgecolor='red')
        plt.title(f'This chart has {np} points')
        plt.xlabel('x data')
        plt.ylabel('y data')
        chart.set_figure(f)
        plt.close(f)

def subtract_point(self, msg):
    self.num_points -= 1
    np = self.num_points
    f = plt.figure(figsize=(2, 2))
    plt.plot([i*i for i in range(np)], marker='*', markersize=20, markeredgecolor='red')
    plt.title(f'This chart has {np} points')
    plt.xlabel('x data')
    plt.ylabel('y data')
    self.set_figure(f)
    plt.close(f)

def plot_test():
    wp = jp.WebPage()
    f = plt.figure(figsize=(2, 2))
    plt.plot([0, 1, 4, 9], marker='*', markersize=20, markeredgecolor='red')
    plt.title('Matplotlib Example')
    plt.xlabel('x data')
    plt.ylabel('y data')
    d = jp.Div(classes='flex flex-wrap', a=wp)
    chart_list = []
    for i in range(5):
        chart = jp.Matplotlib(a=d, classes='m-1 p-2')
        chart.num_points = 4
        chart_list.append(chart)
        chart.on('click', subtract_point)

    plt.close(f)

    b = jp.Button(text='Add Point', a=wp,
                  classes='m-2 bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded')
    b.chart_list = chart_list
    b.on('click', add_point)

    return wp


jp.justpy(plot_test)
</code></pre>
<p>In order to handle each chart separately, we create 20 distinct chart elements and assign to the button the list of the chart elements we created and then iterate over the charts in the button's click event handler.</p>
<h2 id="creating-matplotlib-charts-with-pandas">Creating matplotlib charts with pandas</h2>
<p>Pandas provides a <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html">visualization layer</a> over matplotlib. </p>
<p>Since pandas creates matplotlib plots, the Matplotlib component works in this case as well. Simply call Matplotlib when in your code you would normally call <code>plt.show()</code>. </p>
<p>!!! tip
    If you create matplotlib charts within request handlers, don't forget to close the matplotlib figures associated with them in order to conserve memory and make your application scalable.</p>
<p>!!! note
    The example below takes about 15 seconds to load a request, it is not hanging</p>
<pre><code class="language-python">import justpy as jp
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# All examples from https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html

def plot_test():
    wp = jp.WebPage()

    jp.Div(text='Series Plot', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    ts = pd.Series(np.random.randn(1000), index=pd.date_range('1/1/2000', periods=1000))
    ts = ts.cumsum()
    ts.plot()
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Frame Plot', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df = pd.DataFrame(np.random.randn(1000, 4), index=ts.index, columns=list('ABCD'))
    df = df.cumsum()
    df.plot()
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Histogram', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df4 = pd.DataFrame({'a': np.random.randn(1000) + 1, 'b': np.random.randn(1000), 'c': np.random.randn(1000) - 1}, columns=['a', 'b', 'c'])
    df4.plot.hist(alpha=0.5)
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Multiple Subplots', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df.diff().hist(color='k', alpha=0.5, bins=50)
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Multiple Pie Charts', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df_pie = pd.DataFrame(3 * np.random.rand(4, 2),index=['a', 'b', 'c', 'd'], columns=['x', 'y'])
    df_pie.plot.pie(subplots=True, figsize=(8, 4))
    jp.Matplotlib(a=wp)
    plt.close()

    # The following example takes some time (about 15 seconds) to generate, so the page loads slowly
    jp.Div(text='Plotting Tools, Scatter Matrix', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df_scatter = pd.DataFrame(np.random.randn(1000, 4), columns=['a', 'b', 'c', 'd'])
    pd.plotting.scatter_matrix(df_scatter, alpha=0.2, figsize=(10, 10), diagonal='kde')
    jp.Matplotlib(a=wp)
    plt.close()

    return wp

jp.justpy(plot_test)
</code></pre>
<p>If you don't need to customize the chart for each request, you can speed up your website's response time by generating the charts once and serving the same chart elements with each request.</p>
<p>Here is the program above modified in this fashion:</p>
<pre><code class="language-python">import justpy as jp
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# All examples from https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html

def create_page():
    wp = jp.WebPage(delete_flag=False)

    jp.Div(text='Series Plot', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    ts = pd.Series(np.random.randn(1000), index=pd.date_range('1/1/2000', periods=1000))
    ts = ts.cumsum()
    ts.plot()
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Frame Plot', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df = pd.DataFrame(np.random.randn(1000, 4), index=ts.index, columns=list('ABCD'))
    df = df.cumsum()
    df.plot()
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Histogram', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df4 = pd.DataFrame({'a': np.random.randn(1000) + 1, 'b': np.random.randn(1000), 'c': np.random.randn(1000) - 1}, columns=['a', 'b', 'c'])
    df4.plot.hist(alpha=0.5)
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Multiple Subplots', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df.diff().hist(color='k', alpha=0.5, bins=50)
    jp.Matplotlib(a=wp)
    plt.close()

    jp.Div(text='Multiple Pie Charts', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df_pie = pd.DataFrame(3 * np.random.rand(4, 2),index=['a', 'b', 'c', 'd'], columns=['x', 'y'])
    df_pie.plot.pie(subplots=True, figsize=(8, 4))
    jp.Matplotlib(a=wp)
    plt.close()

    # The following example takes some time (about 10 seconds) to generate.
    jp.Div(text='Plotting Tools, Scatter Matrix', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    df_scatter = pd.DataFrame(np.random.randn(1000, 4), columns=['a', 'b', 'c', 'd'])
    pd.plotting.scatter_matrix(df_scatter, alpha=0.2, figsize=(10, 10), diagonal='kde')
    jp.Matplotlib(a=wp)
    plt.close()

    return wp

wp = create_page()

def plot_test():
    return wp

jp.justpy(plot_test)
</code></pre>
<h2 id="creating-charts-with-seaborn">Creating charts with seaborn</h2>
<blockquote>
<p><a href="https://seaborn.pydata.org/index.html">Seaborn</a> is a Python data visualization library based on matplotlib. It provides a high-level interface for drawing attractive and informative statistical graphics.</p>
</blockquote>
<p>Seaborn allows you to create beautiful visualizations with few lines of code.</p>
<p>Again, since seaborn, like pandas' visualization, is based on matplotlib, Matplotlib (the JustPy component) works well also with seaborn.</p>
<p>Following are a few examples taken from the <a href="https://seaborn.pydata.org/introduction.html">seaborn introduction</a>:</p>
<pre><code class="language-python">import justpy as jp
import seaborn as sns

# All examples from https://seaborn.pydata.org/introduction.html

def create_page():
    wp = jp.WebPage(delete_flag=False)
    chart_classes = 'm-2'

    jp.Div(text='Tips Dataset', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    sns.set()
    tips = sns.load_dataset(&quot;tips&quot;)
    sns.relplot(x=&quot;total_bill&quot;, y=&quot;tip&quot;, col=&quot;time&quot;,
                hue=&quot;smoker&quot;, style=&quot;smoker&quot;, size=&quot;size&quot;,
                data=tips)
    jp.Matplotlib(a=wp, classes=chart_classes)
    sns.lmplot(x=&quot;total_bill&quot;, y=&quot;tip&quot;, col=&quot;time&quot;, hue=&quot;smoker&quot;,
               data=tips)
    jp.Matplotlib(a=wp, classes=chart_classes)
    sns.catplot(x=&quot;day&quot;, y=&quot;total_bill&quot;, hue=&quot;smoker&quot;,
                kind=&quot;swarm&quot;, data=tips)
    jp.Matplotlib(a=wp, classes=chart_classes)
    sns.catplot(x=&quot;day&quot;, y=&quot;total_bill&quot;, hue=&quot;smoker&quot;,
                kind=&quot;violin&quot;, split=True, data=tips)
    jp.Matplotlib(a=wp, classes=chart_classes)

    jp.Div(text='Dots Dataset', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    dots = sns.load_dataset(&quot;dots&quot;)
    sns.relplot(x=&quot;time&quot;, y=&quot;firing_rate&quot;, col=&quot;align&quot;,
                hue=&quot;choice&quot;, size=&quot;coherence&quot;, style=&quot;choice&quot;,
                facet_kws=dict(sharex=False),
                kind=&quot;line&quot;, legend=&quot;full&quot;, data=dots)
    jp.Matplotlib(a=wp, classes=chart_classes)

    jp.Div(text='FMRI Dataset', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    fmri = sns.load_dataset(&quot;fmri&quot;)
    sns.relplot(x=&quot;timepoint&quot;, y=&quot;signal&quot;, col=&quot;region&quot;,
                hue=&quot;event&quot;, style=&quot;event&quot;,
                kind=&quot;line&quot;, data=fmri)
    jp.Matplotlib(a=wp, classes=chart_classes)

    jp.Div(text='Iris Dataset', a=wp, classes='text-white bg-blue-500 text-center text-xl')
    iris = sns.load_dataset(&quot;iris&quot;)
    sns.jointplot(x=&quot;sepal_length&quot;, y=&quot;petal_length&quot;, data=iris)
    jp.Matplotlib(a=wp, classes=chart_classes)
    sns.pairplot(data=iris, hue=&quot;species&quot;)
    jp.Matplotlib(a=wp, classes=chart_classes)

    return wp


wp = create_page()

def plot_test():
    return wp

jp.justpy(plot_test)
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
